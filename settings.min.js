//
(function(){var b=/\s*[+-]\d*\.?\d+/,c=function(h,j){var i=Math.pow(10,parseInt(j)||0);return Math.round(h*i)/i},a=function(j,i,h){return Math.max(j,Math.min(i,h))},g=function(h){h._dec=parseInt(h._hex.substr(1),16)};dec2hex=function(h){var i=h._dec.toString(16);h._hex="#000000".substr(0,7-i.length)+i.toUpperCase()},dec2rgb=function(h){h._rgb=[h._dec>>16,(h._dec>>8)&255,h._dec&255]},rgb2dec=function(h){h._dec=h._rgb[0]<<16|(h._rgb[1]<<8)&65535|h._rgb[2]},rgb2hsl=function(k){var i=k._rgb[0]/255,o=k._rgb[1]/255,t=k._rgb[2]/255,m=Math.min(i,Math.min(o,t)),u=Math.max(i,Math.max(o,t)),p=u+m,q=u-m,j=p/2,v=j>0&&j<1?q/(j<0.5?p:(2-p)):0,n=q>0?u==i?(o-t)/q+(o<t?6:0):u==o?(t-i)/q+2:u==t?(i-o)/q+4:0:0;k._hsl=[c(n*60,2),c(v*100,2),c(j*100,2)]},hue2rgb=function(k,j,i){i+=i<0?1:(i>1?-1:0);return c((i*6<1?k+(j-k)*i*6:i*2<1?j:i*3<2?k+(j-k)*(2/3-i)*6:k)*255,2)},hsl2rgb=function(j){var m=j._hsl[0]/360,k=j._hsl[1]/100,i=j._hsl[2]/100;if(k==0){i=c(i*255);j._rgb=[i,i,i]}else{var n=i<0.5?i*(1+k):i+k-i*k,o=2*i-n;j._rgb=[hue2rgb(o,n,m+1/3),hue2rgb(o,n,m),hue2rgb(o,n,m-1/3)]}},validate=function(j,h){if(h===undefined||h===null){return false}switch(j){case"rgb":return a(0,parseInt(h),255);case"h":return((parseFloat(h)%360)+360)%360;case"sl":return a(0,parseFloat(h),100);case"hex":var i=h.match(/#([0-9a-f]{6}|[0-9a-f]{3})/i);if(i){i=i[1].toUpperCase();if(i.length==3){i=i.replace(/([0-9A-F])/g,"$1$1")}return"#"+i}}return false},update=function(h,i){switch(i){case"rgb":rgb2dec(h);dec2hex(h);rgb2hsl(h);break;case"hsl":hsl2rgb(h);rgb2dec(h);dec2hex(h);break;case"hex":g(h);dec2rgb(h);rgb2hsl(h);break}if(h._fn){h._fn.call(h)}},Color=function(h,i){this._rgb=[0,0,0];this._hsl=[0,0,0];this._hex="#000000";this._dec=0;this._fn=i;this.hex(h)};Color.prototype.rgb=function(i){if(i==undefined||i==null){return this._rgb}var k=validate("rgb",i[0]),j=validate("rgb",i[1]),h=validate("rgb",i[2]);if(this._rgb[0]!=k||this._rgb[1]!=j||this._rgb[2]!=h){this._rgb=[k,j,h];update(this,"rgb")}return this};Color.prototype.hsl=function(j){if(j==undefined||j==null){return this._hsl}var m=validate("h",j[0]),k=validate("sl",j[1]),i=validate("sl",j[2]);if(m===false||k===false||i===false){return this}if(this._hsl[0]!=m||this._hsl[1]!=k||this._hsl[2]!=i){this._hsl=[m,k,i];update(this,"hsl")}return this};Color.prototype.hex=function(i){if(i==undefined||i==null){return this._hex}var h=validate("hex",i);if(h&&this._hex!=h){this._hex=h;update(this,"hex")}return this};var d=["red","green","blue"];for(var f=0;f<3;f++){Color.prototype[d[f]]=(function(h){return function(i){if(i===undefined||i===null){return this._rgb[h]}var j=i;if(typeof i=="string"&&i.match(b)){j=this._rgb[h]+parseInt(i)}j=validate("rgb",j);if(j!=this._rgb[h]){this._rgb[h]=j;update(this,"rgb")}return this}})(f)}var e=["hue","saturation","lightness"];for(var f=0;f<3;f++){Color.prototype[e[f]]=(function(h){return function(i){if(i==undefined||i==null){return this._hsl[h]}var j=i;if(typeof i=="string"&&i.match(b)){j=this._hsl[h]+parseFloat(i)}j=validate(h==0?"h":"sl",j);if(this._hsl[h]!=j){this._hsl[h]=j;update(this,"hsl")}return this}})(f)}Color.prototype.fn=function(){if(this._fn){return this._fn.apply(this,arguments)}return this};Color.prototype.toString=function(){return this._hex};window.Color=Color})();(function(h){var e='<div class="farbtastic"><div class="color"/><div class="wheel"/><div class="overlay"/><div class="h-marker marker"/><div class="sl-marker marker"/></div>';var b=84,g=100,c=97,f=false,a=function(){var i=this.currentStyle.backgroundImage;if(i!="none"){h(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=crop,src='"+i.substring(5,i.length-2)+"')"})}},d=function(k,w){var r=h(document),y=h(k).html(e),n=y.children(),v=n.children(".wheel"),o=n.children(".h-marker"),m=n.children(".sl-marker"),p=n.children(".color"),j=false,q=new Color("#000000",function(){var z=this._hsl[0]*6.28/360;o.css({left:Math.round(Math.sin(z)*b)+c,top:Math.round(-Math.cos(z)*b)+c});m.css({left:c-Math.round(g*(this._hsl[1]/100-0.5)),top:c-Math.round(g*(this._hsl[2]/100-0.5))});p.css("backgroundColor",i.hue(q._hsl[0]).hex());if(w){w.call(this)}}),i=new Color("#FF0000"),x=function(z){var A=v.offset();return{x:(z.pageX-A.left)-c,y:(z.pageY-A.top)-c}},l=function(z){if(z.which!=1){return false}if(!f){r.on(u);f=true}var A=x(z);j=Math.max(Math.abs(A.x),Math.abs(A.y))*2>g;t(z);return false},t=function(z){var A=x(z);q.hsl(j?[Math.atan2(A.x,-A.y)*360/6.28,q._hsl[1],q._hsl[2]]:[q._hsl[0],-100*(A.x/g)+50,-100*(A.y/g)+50])},s=function(){r.off(u);f=false},u={mousemove:t,mouseup:s};if(navigator.appVersion.match(/MSIE [0-6]\./)){n.children().each(a)}n.on("mousedown",l);return q};h.kt_colorpicker=function(i,j){return d(i,j)}})(jQuery);(function(b,a){b(function(){var t=b(document),q=b("#editor"),c=b("#colors"),s=b(a.replace(/%1\$s/g,"#000000").replace(/%2\$s/g,"").replace(/%3\$s/g,"x")),d=b("#picker"),k=null,h=null,p=b.kt_colorpicker(d,function(){if(k){var u=this.hex();k.siblings(".hex").val(u);k.children(".preview").css("backgroundColor",u)}}),i=function(v){var u=String(v).toUpperCase().match(/([0-9A-F]{6}|[0-9A-F]{3})/);if(u){if(u[1].length==3){return"#"+u[1].replace(/([0-9A-F])/g,"$1$1")}return"#"+u[1]}return false},n=function(){d.attr("aria-hidden","true");t.off("mousedown",j)},j=function(u){if(!b(u.target).closest(k).length){n()}},o=function(u){if(u.which==1){if(d.attr("aria-hidden")=="true"){t.on("mousedown",j);k=b(this);d.attr("aria-hidden","false").position({of:k,at:"left bottom",my:"left top-1px"})}else{n()}}},l=function(){var v=b(this),u=i(v.val());if(u){v.val(u).parent().find(".preview").css("backgroundColor",u)}},r=function(u){if(b(u.target).is(".picker")){if(u.type=="focusin"){h=b(this).attr("aria-grabbed","true").on("keydown",g)}else{h.off("keydown",g).attr("aria-grabbed","false")}}},g=function(v){switch(v.which){case 37:case 38:if(h.prev().length){h.after(h.prev());return false}break;case 39:case 40:if(h.next().length){h.before(h.next());return false}break;case 46:var u=h.next();if(!u.length){u=h.prev()}h.remove();u.trigger("focus");break}},m=function(u){if(u.type=="focusin"){k=b(this).on("keydown",f);p.hex(k.siblings(".hex").val()).fn()}else{n();k.off("keydown",f)}},f=function(w){var u=w.ctrlKey||w.shiftKey||w.metaKey?5:2.5,v="+"+u,y="-"+u;switch(w.which){case 109:case 189:p.hue(y);return false;case 107:case 187:p.hue(v);return false;case 38:p.lightness(v);return false;case 40:p.lightness(y);return false;case 37:p.saturation(v);return false;case 39:p.saturation(y);return false;case 27:n();return false}},e=function(w){if(w.type=="focusin"){var v=b(this);if(i(this.value)){v.data("lastValue",this.value)}var u=v.data("autoFill");if(u){clearTimeout(u);v.removeData("autoFill")}}else{if(!i(this.value)){var v=b(this),u=setTimeout(function(){v.val(v.data("lastValue"))},5000);v.data("autoFill",u)}}};b("#custom").on("change",function(){q.attr("aria-hidden",this.checked?"false":"true")});b("#add").on("click",function(u){s.clone().appendTo(c);u.preventDefault()});c.on("click",".remove",function(u){b(this).parent().remove();u.preventDefault()});c.on("click",".handle",function(){b(this).parent().trigger("focus")});c.on("focus blur",".picker",r);c.on("click",".color",o);c.on("focus blur",".color",m);c.on("change",".hex",l);c.on("focus blur",".hex",e);c.sortable({placeholder:"picker-placeholder",items:".picker",distance:2,tolerance:"pointer",helper:"clone",opacity:0.65,stop:function(v,u){u.item.trigger("focus")}})})})(jQuery,kt_TinyMCE_prototype);